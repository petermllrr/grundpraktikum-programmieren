package io.petermueller.petrinetz.controllers;

import io.petermueller.petrinetz.models.petrinet.PetriNetModel;
import io.petermueller.petrinetz.models.rgraph.RGraphModel;
import io.petermueller.petrinetz.util.Event;
import io.petermueller.petrinetz.util.EventListener;

public class RGraphController {
	protected RGraphModel rGraphModel;
	protected PetriNetModel petriNetModel;
	
	public RGraphController(
			RGraphModel rGraphModel,
			PetriNetModel petriNetModel) {
		this.rGraphModel = rGraphModel;
		this.petriNetModel = petriNetModel;
		addPetriNetEventListener();
	}
	
	protected void addPetriNetEventListener() {
		petriNetModel.addEventListener(new EventListener() {
			@Override
			public void event(Event eventType) {
				if (eventType == Event.PETRINET_TRANSITION_FIRED) {
					rGraphModel.addTransition(
						petriNetModel.places,
						petriNetModel.lastTransition);
				}
				if (eventType == Event.PETRINET_MARKING_EDITED) {
					rGraphModel.reset(petriNetModel.places);
				}
				if (eventType == Event.PETRINET_MARKING_RESET) {
					rGraphModel.goToMarking(petriNetModel.places);
				}
			}
		});
	}
}
